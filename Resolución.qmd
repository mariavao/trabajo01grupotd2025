---
title: "Resolución"
author: "Grupo 7"
editor: visual
date: "`r Sys.Date()`"
date-format: "DD/MM/YYYY"
lang: es
toc: true
toc-depth: 4
number-sections: true
format:
  html:
    code-tools: true
    code-fold: true
  pdf: 
    keep-tex: true
    header-includes:
      - \usepackage{float}
      - \floatplacement{table}{H}
      - \floatplacement{figure}{H}
execute: 
  echo: true
  warnings: false
---

\pagebreak

# Previo al planteamiento de los problemas

Implementamos las funciones de incertidumbre a utilizar

```{r}
source("teoriadecision_funciones_incertidumbre.R")

```

Cargamos la librería tinytable para presentar las tablas en un mejor formato

```{r}
library(tinytable)

```

\pagebreak

# Problema 1

Aplicar los criterios de decisión bajo incertidumbre al problema cuya matriz de valores numéricos viene dada en la siguiente tabla:

|     | e1  | e2  | e3  | e4  | e5  |
|-----|-----|-----|-----|-----|-----|
| d1  | 90  | 40  | 60  | 40  | 75  |
| d2  | 50  | 70  | 55  | 65  | 60  |
| d3  | 20  | 80  | 90  | 75  | 50  |
| d4  | 70  | 45  | 40  | 95  | 30  |

Donde ei indica los estados de la naturaleza (desde i = 1,...,5) y di indica las diferentes alternativas / decisiones a tomar (desde i = 1,...,4)

Considera el problema primero de beneficios (favorable) y posteriormente de costos (desfavorable).

## Creación de la matriz

```{r}
# Creamos la tabla con la función crea.tablaX
tabla1 = crea.tablaX(c(90,40, 60, 40, 75,
                       50, 70, 55, 65, 60,
                       20, 80, 90, 75, 50, 
                       70, 45, 40, 95, 30), numalternativas = 4, numestados = 5)

# Convertimos la tabla en un data.frame
tabla_1 = as.data.frame(tabla1)

# Presentamos la tabla de valores
tt(tabla_1, rownames = T)
```

## Resolución de beneficios

Vamos a resolver esta matriz de valores para el caso de beneficios, en cada uno de los criterios dados en la asignatura.

### Criterio de Wald o Pesimista

El criterio de Wald selecciona la alternativa cuyo peor resultado sea el más alto posible. Es decir, asume una postura pesimista: se elige la opción que garantiza el mejor mínimo beneficio.

```{r}
sol_11 = criterio.Wald(tabla1, favorable = T)
sol_11
```

La mejor alternativa según el criterio de Wald, es la alternativa 2.

### Criterio optimista

El criterio optimista (también llamado de Maximax) elige la alternativa con el máximo beneficio posible, suponiendo que siempre ocurrirá el mejor escenario.

```{r}
sol_12 = criterio.Optimista(tabla1, favorable = T)
sol_12
```

La mejor alternativa según el criterio optimista, es la alternativa 4.

### Criterio de Hurwicz

Este criterio combina el pesimismo y el optimismo mediante un parámetro α (alfa) entre 0 y 1. Este se calcula como una media ponderada entre el mejor beneficio (ponderado por α) y el peor beneficio (ponderado por 1−α).

Vamos a suponer un nivel de alfa tal que **α = 0.5.**

```{r}
sol_13 = criterio.Hurwicz(tabla1, alfa = 0.5, favorable = T)
sol_13
```

La mejor alternativa según el criterio de Hurwicz, es la alternativa 1.

Construimos las gráficas asociadas al criterio de Hurwicz:

```{r}
alfa = 0.5
dibuja.criterio.Hurwicz(tabla1, favorable = T)
dibuja.criterio.Hurwicz_Intervalos(tabla1, favorable = T)
```

### Criterio de Savage

El criterio de Savage (criterio del mínimo arrepentimiento) busca la alternativa que minimiza la pérdida por no haber elegido la mejor opción en cada estado. Es decir, se elige aquella cuyo peor “arrepentimiento” sea el más pequeño.

```{r}
sol_14 = criterio.Savage(tabla1, favorable = T)
sol_14
```

La mejor alternativa según el criterio de Savage, es la alternativa 2.

### Criterio de Laplace

El criterio de Laplace asume que todos los estados son igualmente probables, y elige la alternativa con el mayor beneficio medio.

```{r}
sol_15 = criterio.Laplace(tabla1, favorable = T)
sol_15
```

La mejor alternativa según el criterio de Laplace, es la alternativa 3.

### Criterio del punto ideal

El criterio del punto ideal busca la alternativa más cercana al punto ideal, es decir, aquella que más se aproxima simultáneamente al máximo beneficio posible en todos los estados.

```{r}
sol_16 = criterio.PuntoIdeal(tabla1, favorable = T)
sol_16
```

La mejor alternativa según el criterio del punto ideal, es la alternativa 2.

## Resolución de costes

Vamos a resolver esta matriz de valores para el caso desfavorable, en cada uno de los criterios dados en la asignatura.

### Criterio de Wald o pesimista

El criterio de Wald selecciona la alternativa cuyo peor resultado sea el más bajo posible.\
Es decir, asume una postura pesimista: se elige la opción que garantiza el menor coste máximo.

```{r}
sol_21 = criterio.Wald(tabla1, favorable = F)
sol_21

```

La mejor alternativa según el criterio de Wald, es la alternativa 2.

### Criterio optimista

El criterio optimista (también llamado de Minimin) elige la alternativa con el menor coste posible, suponiendo que siempre ocurrirá el mejor escenario.

```{r}
sol_22 = criterio.Optimista(tabla1, favorable = F)
sol_22
```

La mejor alternativa según el criterio optimista es la alternativa 3.

### Criterio de Hurwicz

Este criterio combina el pesimismo y el optimismo mediante un parámetro α (alfa) entre 0 y 1. Este se calcula como una media ponderada entre el mejor coste (mínimo) (ponderado por α) y el peor coste (máximo) (ponderado por 1−α).

Vamos a suponer un nivel de alfa tal que **α = 0.5.**

```{r}
sol_23 = criterio.Hurwicz(tabla1, alfa = 0.5, favorable = F)
sol_23
```

La mejor alternativa según el criterio de Hurwicz es la alternativa 3.

Construimos las gráficas asociadas al criterio de Hurwicz:

```{r}
dibuja.criterio.Hurwicz(tabla1, favorable = F)
dibuja.criterio.Hurwicz_Intervalos(tabla1, favorable = F)
```

### Criterio de Savage

El criterio de Savage (criterio del mínimo arrepentimiento) busca la alternativa que minimiza la pérdida por haber elegido la opción más costosa en cada estado. Se elige la alternativa cuyo peor arrepentimiento (coste adicional) sea el menor posible.

```{r}
sol_24 = criterio.Savage(tabla1, favorable = F)
sol_24
```

La mejor alternativa según el criterio de Savage es la alternativa 2.

### Criterio de Laplace

El criterio de Laplace asume que todos los estados son igualmente probables, y selecciona la alternativa con el menor coste medio.

```{r}
sol_25 = criterio.Laplace(tabla1, favorable = F)
sol_25
```

La mejor alternativa según el criterio de Laplace es la alternativa 4.

### Criterio del punto ideal

El criterio del punto ideal busca la alternativa más cercana al punto ideal mínimo, es decir, aquella que más se aproxima simultáneamente al menor coste posible en todos los estados.

```{r}
sol_26 = criterio.PuntoIdeal(tabla1, favorable = F)
sol_26
```

La mejor alternativa según el criterio del punto ideal es la alternativa 2.

\pagebreak

# Problema 2

Miguel está pensando en contratar un servicio de Internet para su hogar. Ha consultado varias compañías y le han dado los siguientes informes:

-   Con Digi debe pagar un cuota mensual de 25€, pero la velocidad máxima solo estará disponible después de 6 meses; hasta entonces, solo tendrá la mitad de velocidad contratada.

-   Con O2 puede disfrutar de la velocidad completa desde el primer mes, pero deberá pagar una cuota de 50€ al mes.

-   Con Vodafone debe pagar 35€ al mes, lo que garantiza la velocidad completa, excepto en horas puntas, cuando la velocidad se reduce.

Miguel trabaja desde casa y necesita Internet para videollamadas frecuentes y descargas grandes de archivos. Supongamos que el coste asociado a la velocidad insuficiente son:

-   Reducción en productividad y retrasos en descargas: 400€

-   Problemas en videollamadas y reuniones importantes: 1000€

Miguel quiere evaluar cuál sería el coste total del primer año, considerando que podría tener meses de alta demanda de trabajo o meses de baja demanda, y cuál sería la mejor compañía a elegir.

## Creación de la matriz

### Planteamiento

Las alternativas a elegir, sería contratar un servicio de Internet con:

-   Digi, cuya cuota mensual es de 25€

-   O2, cuya cuota mensual es de 50€

-   Vodafone, cuya cuota mensual es de 35€

Los estados de la naturaleza de este problema son:

-   Meses de alta demanda (problemas de productividad si la velocidad es insuficiente).

-   Meses de baja demanda (menos impacto si la velocidad es reducida).

Cuyos costos asociados a una velocidad insuficiente son:

-   Reducción en productividad/descargas: 400€

-   Problemas en videollamadas: 1000€

### **Cálculo del coste anual según opción y estado**

Para Digi, con la mitad de velocidad los 6 primeros meses, tenemos que:

-   Cuota anual: 25 × 12 = 300€

-   Coste proporcional por velocidad insuficiente (6/12 del año) = 1400 × 0.5 = 700€

-   Alta demanda: 300 + 700 = 1000€

-   Baja demanda: 300€

Para O2, con una velocidad completa desde el inicio, tenemos que:

-   Cuota anual: 50 × 12 = 600€

-   Velocidad suficiente = 0€

-   Alta demanda: 600€

-   Baja demanda: 600€

Para Vodafone, con velocidad reducida horas puntas, tenemos que:

-   Cuota anual: 35 x 12 = 420€

-   Estimando que las horas puntas reducen el rendimiento un 50% del año: 1400 x 0.5 = 700€

-   Alta demanda: 420 + 700 = 1120€

-   Baja demanda: 420€

### Matriz de valores

```{r}
# Valores de la tabla
m_11 = (25*12)+(1400*0.5)
m_12 = 25*12
m_21 = 50*12
m_22 = 50*12
m_31 = (35*12)+(1400*0.5)
m_32 = 35*12

# Creamos la tabla con la función crea.tablaX
tabla2 = crea.tablaX(c(m_11, m_12,
                       m_21, m_22,
                       m_31, m_32), numalternativas = 3, numestados = 2,
                     nb_alternativas = c("Digi", "O2", "Vodafone"),
                     nb_estados = c("Alta demanda", "Baja demanda"))

# Convertimos la tabla en un data.frame
tabla_2 = as.data.frame(tabla2)

# Presentamos la tabla de valores
tt(tabla_2, rownames = T)
```

## Resolución

Resolvemos el problema con una función, la cual recoge todos los criterios de decisión bajo incertidumbre:

```{r}
sol_2 = criterio.Todos(tabla_2, alfa = 0.5, favorable = F)
tt(sol_2, rownames = T)

```

Podemos ver que cada criterio tiene una alternativa:

-   Criterio de Wald: La mejor opción es contratar O2

-   Criterio Optimista: La mejor opción es contratar Digi

-   Criterio de Hurwicz: La mejor opción es contratar O2

-   Criterio de Savage: La mejor opción es contratar O2

-   Criterio de Laplace: La mejor opción es contratar O2

-   Criterio del Punto Ideal: La mejor opción es contratar O2

Luego, la mejor opción es contratar O2.

\pagebreak

# Problema 3

Aplicar los criterios de decisión bajo incertidumbre a los problemas cuya matriz de valores numéricos vienen dadas en las tablas siguientes: Realizar tanto en situación favorable como desfavorable.

|     | e1  | e2  | e3  | e4  | e5  | e6  |
|-----|-----|-----|-----|-----|-----|-----|
| d1  | 740 | 800 | 500 | 250 | 690 | 900 |
| d2  | 600 | 600 | 600 | 600 | 600 | 600 |
| d3  | 120 | 50  | 90  | 300 | 250 | 10  |
| d4  | 450 | 700 | 900 | 40  | 25  | 5   |
| d5  | 150 | 200 | 500 | 220 | 430 | 400 |

## Creación de la matriz

```{r}
tb01a = crea.tablaX(c(740,800,500,250,690,900,
                      600,600,600,600,600,600,
                      120,50,90,300,250,10,
                      450,700,900,40,25,5,
                      150,200,500,220,430,400),numalternativas=5,numestados=6)


# Convertimos la tabla en un data.frame
tabla_3 = as.data.frame(tb01a)

# Presentamos la tabla de valores
tt(tabla_3, rownames = T)
```

## Solución de beneficios

Veámos las soluciones según los distintos criterios:

### Criterio de Wald:

```{r}
criterio.Wald(tb01a)
```

El criterio de Wald nos indica que la mejor decisión es la alternativa d2 con un valor optimo de 600.

### Método optimista:

```{r}
criterio.Optimista(tb01a)
```

El criterio optimista nos indica que la mejor decisión son las alternativas d1 o d4 con un valor optimo de 900.

### Criterio de Hurwicz:

```{r}
criterio.Hurwicz(tb01a,alfa=0.5)
```

El criterio de Hurwicz nos indica que la mejor decisión para alpha=0.5 es la alternativa d2 con un valor optimo de 600.

Además, moviendo el alpha:

```{r}
dibuja.criterio.Hurwicz_Intervalos(tb01a,T,T)
```

Nos indica que para alpha entre 0 y 0.538 la mejor decisión es d2 y para alpha entre 0.538 y 1, la mejor decisión es d1.

### Criterio de Savage:

```{r}
criterio.Savage(tb01a)
```

El criterio de Savage nos indica que la mejor decisión es la alternativa d2 con un valor optimo de 300.

### Criterio de Laplace:

```{r}
criterio.Laplace(tb01a)
```

El criterio de Laplace nos indica que la mejor decisión es la alternativa d1 con un valor optimo de 646.6667.

### Criterio del Punto Ideal:

```{r}
criterio.PuntoIdeal(tb01a)
```

El criterio del Punto Ideal nos indica que la mejor decisión es la alternativa d2 con un valor optimo de 497.6947.

CONCLUSIÓN:

En situación favorable, según los criterios de decisión bajo incertidumbre, las mejores decisiones son la alternativa d2 (Criterio de Wald, Hurwicz, Savage y Punto Ideal) o la alternativa d1 (Criterio optimista y Laplace).

Si me tuviera que quedar con una única alternativa, elegiría la alternativa d2, ya que es la que más veces aparece como mejor decisión según los distintos criterios.

\pagebreak

## Solución de costes:

### Criterio de Wald:

```{r}
criterio.Wald(tb01a,favorable = FALSE)
```

El criterio de Wald nos indica que la mejor decisión es la alternativa d3 con un valor optimo de 300.

### Método optimista:

```{r}
criterio.Optimista(tb01a,favorable = FALSE)
```

El criterio optimista nos indica que la mejor decisión es la alternativa d4 con un valor optimo de 5.

### Criterio de Hurwicz:

```{r}
criterio.Hurwicz(tb01a,alfa=0.5,favorable = FALSE)
```

El criterio de Hurwicz nos indica que la mejor decisión para alpha=0.5 es la alternativa d3 con un valor optimo de 155.

Además, moviendo el alpha:

```{r}
dibuja.criterio.Hurwicz_Intervalos(tb01a,F,T)
```

Nos indica que para alpha entre 0 y 0.992 la mejor decisión es d3 y para alpha entre 0.992 y 1, la mejor decisión es d4.

### Criterio de Savage:

```{r}
criterio.Savage(tb01a,favorable = FALSE)
```

El criterio de Savage nos indica que la mejor decisión es la alternativa d3 con un valor optimo de 260.

### Criterio de Laplace:

```{r}
criterio.Laplace(tb01a,favorable = FALSE)
```

El criterio de Laplace nos indica que la mejor decisión es la alternativa d1 con un valor optimo de 646.6667.

### Criterio del Punto Ideal:

```{r}
criterio.PuntoIdeal(tb01a,favorable = FALSE)
```

El criterio del Punto Ideal nos indica que la mejor decisión es la alternativa d3 con un valor optimo de 343.875.

CONCLUSIÓN:

En situación de costes, según los criterios de decisión bajo incertidumbre, las mejores decisiones son la alternativa d3 (Criterio de Wald, Hurwicz, Savage y Punto Ideal), la alternativa d4 (Criterio optimista) o la alternativa d1 (Criterio de Laplace).

Si me tuviera que quedar con una única alternativa, elegiría la alternativa d3, ya que es la que más veces aparece como mejor decisión según los distintos criterios.

\pagebreak

# Problema 4

Lucía y Marco tienen que mudarse este sábado y no se ponen de acuerdo sobre cómo hacerlo. Barajan estas opciones: Opción A: Alquilar furgoneta y hacerlo ellos • Pack de 3 horas de furgoneta con km incluidos: 110 €. • Combustible: 12 €. • Hora extra: 35 €. • Si llueve, comprarían fundas/plásticos 8 €. • Si el ascensor del piso nuevo falla, necesitarían 3 horas extra y pedir ayuda puntual 30 € para subir los muebles pesados.

Opción B: Empresa “AhorraMudanzas” • Tarifa base 2 horas: 130 € (furgón y carga/descarga básicos). • Hora extra: 35 €. • Con lluvia o tráfico, suelen tardar 1 hora más. • Si el ascensor está averiado, estiman 2 horas extra y recargo 20 € por subir por escaleras.

Opción C: Empresa “PremiumBox” • Tarifa plana hasta 4 horas: 220 € • Hora extra a partir de la 5.ª: 30 €. • Con lluvia o tráfico normalmente no hay recargos. • Si el ascensor falla, prevén 1 hora extra.

Estados de la naturaleza:

Mudanza fluida (sin lluvia/tráfico y ascensores funcionando).

Lluvia o tráfico moderado.

Ascensor averiado.

SOLUCIÓN:

Estamos ante un problema de decisión con un solo decisor. Puesto que lo que queremos es minimizar el gasto de la mudanza, nos encontramos con un modelo de costos.

Se nos presentan 3 alternativas:

-   d1: Opción A: Alquilar furgoneta y hacerlo ellos.
-   d2: Opción B: Empresa “AhorraMudanzas”.
-   d3: Opción C: Empresa “PremiumBox”.

Los estados de la naturaleza son:

-   e1: Mudanza fluida (sin lluvia/tráfico y ascensores funcionando).
-   e2: Lluvia o tráfico moderado, pero con ascensores en orden.
-   e3: Ascensor averiado, pero sin lluvia ni tráfico.

## Valoraciones:

Para e1:

```{r}
m11 = 110+12
m21 = 130
m31 = 220
```

Para e2:

```{r}
m12 = 110+12+8
m22 = 130+35
m32 = 220
```

Para e3:

```{r}
m13 = 110+12+30+3*35
m23 = 130+20+2*35
m33 = 220+30
```

## Creación de la matriz

Construimos la tabla de decisiones:

```{r}
tb02 = crea.tablaX(c(m11,m12,m13,
                      m21,m22,m23,
                      m31,m32,m33),numalternativas=3,numestados=3)


# Convertimos la tabla en un data.frame
tabla_4 = as.data.frame(tb02)

# Presentamos la tabla de valores
tt(tabla_4, rownames = T)
```

## Solución de costes:

En esta ocasión, vamos a aplicar todos los criterios a la vez con un único comando:

```{r}
criterio.Todos(tb02,alfa=0.5,favorable = FALSE)
```

Veamos también el criterio de Hurwicz variando alpha:

```{r}
dibuja.criterio.Hurwicz_Intervalos(tb02,F,T)
```

Vemos que para alpha entre 0 y 0.822 la mejor decisión es d2 y para alpha entre 0.822 y 1, la mejor decisión es d1.

Conclusión:

Observando los resultados de la tabla, la mejor decisión es la alternativa 2 (Empresa “AhorraMudanzas"). Esto es debido a que en 4 de los 6 criterios se toma como la mejor opción.

\pagebreak

# Problema 5
Dada la siguiente tabla que recoge una matriz de valores numéricos, aplicar los criterios de decisión bajo incertidumbre:

|    | e1  | e2 | e3 | e4 |
| -- | --- | -- | -- | -- |
| d1 | 85  | 40 | 65 | 30 |
| d2 | 55  | 70 | 50 | 90 |
| d3 | 20  | 95 | 80 | 45 |
| d4 | 75  | 60 | 40 | 85 |
| d5 | 100 | 55 | 70 | 20 |


Siendo ei los distintos estados de la naturaleza (i= [1,4]) y di, las distintas opciones (i=[1,5])
Resolver tanto para beneifcioes como para costos

# Creamos la tabla para poder tratarla
```{r}
tablita = crea.tablaX(c(85,40, 65, 30,
                       55, 70, 50, 90, 
                       20, 95, 80, 45, 
                       75, 60, 40, 85,
                       100, 55, 70, 20), numalternativas = 5, numestados = 4)

# Convertimos la tabla en un data.frame
tablita = as.data.frame(tablita)

# Comprobamos
tt(tablita, rownames = T)
```
#Caso de beneficios

### Criterio de Wald:

```{r}
criterio.Wald(tablita)
```

La decisión óptima en este caso es d2, con un valor de 50.

###Criterio Maximax (optimista)

```{r}
criterio.Optimista(tablita)
```

La decisión óptima usando este criterio es d5, con un valor de 100.

### Criterio de Hurwicz:
 (Nótese que de aquí en adelante, para este ejercicio siempre usaremos 0.5 para el valor de α)

```{r}
criterio.Hurwicz(tablita,alfa=0.5)
```

Mediante Hurwicz llegamos a la conclusión de que la decisión óptima para α=0.5 es d2, con un valor de 70.

Comprobamos mediante un gráfico cómo varía al hacerlo el alfa
  
```{r}
dibuja.criterio.Hurwicz_Intervalos(tablita,T)
```

Observamos que para α hasta 0,75, la mejor opción es d2, mientras que de 0,75 a 1, es d5

### Criterio de Savage:

```{r}
criterio.Savage(tablita)
```
Savage nos indica que la mejor decisión es d4, cuyo valor bajo este criterio es 40.

### Criterio de Laplace:

```{r}
criterio.Laplace(tablita)
```
Con las condiciones propuestas por el criterio de Laplace, la decisión óptima es d2, con un valor de 66.25

### Criterio del Punto Ideal:

```{r}
criterio.PuntoIdeal(tablita)
```

Siguiendo este criterio, la decisión óptima es d4, cuyo valor es 58.94913

Vemos que la solución que más se repite es d2 en el caso de beneficios.

# Caso:Costes
Ahora haremos el análisis para el caso de costes

### Criterio de Wald:

```{r}
criterio.Wald(tablita,F)
```

Las decisiones óptimas en este caso son d1 y d4, ambas con un valor de 85.

###Criterio Maximax (optimista)

```{r}
criterio.Optimista(tablita,F)
```

Las decisiones óptimas usando este criterio son d3 y d5, con un valor de 20 ambas.

### Criterio de Hurwicz:
(Nótese que de aquí en adelante, para este ejercicio siempre usaremos 0.5 para el valor de α)

```{r}
criterio.Hurwicz(tablita,alfa=0.5,F)
```

Mediante Hurwicz llegamos a la conclusión de que las decisiones óptimas para α=0.5 son d1 y d3, con un valor de 57.5

Comprobamos mediante un gráfico cómo varía al hacerlo el alfa

```{r}
dibuja.criterio.Hurwicz_Intervalos(tablita,F)
```

Observamos que para α hasta 0.5, la mejor opción es d1, mientras que de 0.5 a 1, es d3.

### Criterio de Savage:

```{r}
criterio.Savage(tablita,F)
```
Savage nos indica que la mejor decisión es d3, cuyo valor bajo este criterio es 55.

### Criterio de Laplace:

```{r}
criterio.Laplace(tablita,F)
```
Con las condiciones propuestas por el criterio de Laplace, la decisión óptima es d1, con un valor de 55

### Criterio del Punto Ideal:

```{r}
criterio.PuntoIdeal(tablita,F)
```

Siguiendo este criterio, la decisión óptima es d1, cuyo valor es 70.35624



Vemos que la solución que más se repite es d1 en el caso de costes.

\pagebreak


# Problema 6

El juego de cartas Magic:The Gathering ha anunciado una colaboación con Sonic The Hedgehog.
David, que es muy fan de ambas marcas, quiere comprar uno de los Secret Lairs, pero no se decide por cual decantarse.Además, debe tener en cuenta las siguientes posibilidades:
Debido a la alta demanda, Wizard of the Coast no puede garantizar en que idioma llegarán los pedidos. Lo más probable es que lleguen en inglés, pero si fuera en español, el precio aumentaría debido a la exclusividad y demanda de cada set.
Como el día de salida irá mucha gente a la tienda, es posible que vayan vendedores con mucho inventario, lo que le permitiría comprar además mejoras para el set que se compre.
Como tiene que hacer la reserva por adelantado, debe decirle al dueño de la tienda que set va a reservar.Sus opciones son:
  
Opción 1-Sonic:Friend and Foes
Coste base:28€
Extra en español:7€
Mejoras:5€

Opcion 2-Sonic:Chasing Adventures
Coste base:22€
Extra en español:15€
Mejoras:8€

Opcion 3-Sonic:Turbo Gear
Coste base:24€
Extra en español:6€
Mejoras:12€

Estados de la naturaleza:
  
Set base sin mejoras

Set en español sin mejoras

Set base con mejoras

Set en español con mejoras

#Resolución

Primero, crearemos los distintos valores. mi_j, siendo i=las distintas opciones/set (1,2,3), y j=los distintos estados de la naturaleza (1,2,3,4)

m1_1=28
m1_2=28+7
m1_3=28+5
m1_4=28+7+5
m2_1=22
m2_2=22+15
m2_3=22+8
m2_4=22+15+8
m3_1=24
m3_2=24+6
m3_3=24+12
m3_4=24+6+12

magictabla= crea.tablaX(c(m1_1,m1_2,m1_3,m1_4,
                          m2_1,m2_2,m2_3,m2_4,
                          m3_1,m3_2,m3_3,m3_4), numalternativas = 3, numestados = 4,
                     nb_alternativas = c("Friends and Foes", "Chasing Adventures", "Turbo Gear"),
                     nb_estados = c("Base", "Español", "Base upgraded", "Español upgraded"))  

# Convertimos la tabla en un data.frame
magictabla = as.data.frame(magictabla)

# Comprobamos
tt(magictabla, rownames = T)

Esta vez, en lugar de ir uno a uno, usaremos una función que aplica todos los criterios 
(Nótese que, al igual que en el ejercicio anteior,usaremos α=0.5)

criterio.Todos(magictabla,alfa=0.5,F)

Llegamos a la conclusión de que la mejor opción a reservar es la tercera; Sonic:Turbo Gear, ya que es la óptima en 4 de los 6 criterios aplicados

\pagebreak
